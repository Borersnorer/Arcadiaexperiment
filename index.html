<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Interactive Book</title>
<style>
  body {
    margin: 0;
    background: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .book-container {
    position: relative;
    perspective: 2000px;
    width: 800px;
    height: 500px;
  }
  .page, .front-sheet, .back-sheet, .left-page {
    position: absolute;
    width: 400px;
    height: 500px;
    top: 0;
    backface-visibility: hidden;
  }
  .front-sheet {
    left: 400px;
    transform-origin: left center;
    transform: rotateY(0deg);
    z-index: 20;
  }
  .back-sheet {
    left: 400px;
    background: white;
    z-index: 10;
  }
  .left-page {
    left: 0;
    background: white;
    transform-origin: right center;
    transform: rotateY(90deg);
    z-index: 5;
  }
  .hotspot {
    position: absolute;
    background: rgba(255, 0, 0, 0.3);
    cursor: pointer;
    z-index: 30;
  }
  .hotspot:hover {
    background: rgba(255, 0, 0, 0.5);
  }
  .buttons {
    position: absolute;
    top: -60px;
    left: 0;
    display: flex;
    gap: 10px;
  }
  button {
    padding: 5px 10px;
    cursor: pointer;
  }
</style>
</head>
<body>
<div class="book-container" id="book">
  <div class="buttons">
    <button onclick="openBook(1)">Open Page 1</button>
    <button onclick="openBook(2)">Open Page 2</button>
  </div>

  <img src="cover.png" class="front-sheet" id="cover">
  <img src="page.png" class="back-sheet" id="rightPage">
  <img src="page.png" class="left-page" id="leftPage">

  <!-- Hotspots -->
  <div class="hotspot" style="top: 50px; left: 420px; width: 100px; height: 100px;" onclick="alert('Hotspot 1 clicked!')"></div>
  <div class="hotspot" style="top: 200px; left: 420px; width: 150px; height: 100px;" onclick="alert('Hotspot 2 clicked!')"></div>
</div>

<script>
let isAnimating = false;

function openBook(pageNumber) {
  if (isAnimating) return; // Prevent overlapping animations
  isAnimating = true;

  const cover = document.getElementById('cover');
  const leftPage = document.getElementById('leftPage');
  const rightPage = document.getElementById('rightPage');

  // Reset states
  cover.style.transition = 'none';
  cover.style.transform = 'rotateY(0deg)';
  leftPage.style.transition = 'none';
  leftPage.style.transform = 'rotateY(90deg)';
  rightPage.style.visibility = 'visible';
  leftPage.style.visibility = 'visible';

  // Force reflow
  void cover.offsetWidth;

  const coverDuration = 2000; // 2 seconds
  const overlapTime = 300; // start left page this much before cover ends

  // Animate cover opening
  cover.style.transition = `transform ${coverDuration}ms ease-in-out`;
  cover.style.transform = 'rotateY(-180deg)';

  // Animate left page slightly before cover ends
  setTimeout(() => {
    leftPage.style.transition = 'transform 1s ease-in-out';
    leftPage.style.transform = 'rotateY(0deg)';
  }, coverDuration - overlapTime);

  // Allow next animation after cover finishes
  setTimeout(() => {
    isAnimating = false;
  }, coverDuration + 100);
}

document.getElementById('book').addEventListener('click', (e) => {
  if (e.target.tagName !== 'BUTTON' && !e.target.classList.contains('hotspot')) {
    closeBook();
  }
});

function closeBook() {
  if (isAnimating) return;
  isAnimating = true;

  const cover = document.getElementById('cover');
  const leftPage = document.getElementById('leftPage');

  cover.style.transition = 'transform 2s ease-in-out';
  cover.style.transform = 'rotateY(0deg)';

  leftPage.style.transition = 'transform 1s ease-in-out';
  leftPage.style.transform = 'rotateY(90deg)';

  setTimeout(() => {
    isAnimating = false;
  }, 2100);
}
</script>
</body>
</html>
